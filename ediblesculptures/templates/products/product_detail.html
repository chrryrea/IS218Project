{% extends 'base.html' %}
{% block title %}{{ product.name }} - Edible Sculptures{% endblock %}

{% block content %}
<div class="product-detail">
    <div class="product-images">
        <img src="{{ product.image.url }}" alt="{{ product.name }}" class="main-image">
    </div>
    
    <div class="product-info">
        <h2>{{ product.name }}</h2>
        <p class="price">${{ product.price }}</p>
        <p class="description">{{ product.description }}</p>
        
        <div class="cart-buttons">
            <form action="{% url 'cart_add' product.pk %}" method="post" class="cart-form">
                {% csrf_token %}
                <div class="quantity-selector">
                    <label for="quantity">Quantity:</label>
                    <input type="number" name="quantity" id="quantity" value="1" min="1" max="10">
                </div>
                <button type="submit" class="btn btn-primary">Add to Cart</button>
            </form>
        </div>
    </div>
</div>

<div class="reviews-section">
    <h3>Customer Reviews</h3>
    
    {% for feedback in feedbacks %}
    <div class="review">
        <div class="review-header">
            <h4>{{ feedback.user.username }}</h4>
            <div class="rating">
                {% for i in "12345" %}
                    {% if forloop.counter <= feedback.rating %}
                        <span class="star">★</span>
                    {% else %}
                        <span class="star">☆</span>
                    {% endif %}
                {% endfor %}
            </div>
            <span class="date">{{ feedback.created_at }}</span>
        </div>
        <p class="review-text">{{ feedback.comment }}</p>
    </div>
    {% empty %}
    <p class="no-reviews">No reviews yet. Be the first to leave a review!</p>
    {% endfor %}
</div>

<div class="add-review">
    <h3>Leave a Review</h3>
    <form method="post" class="review-form">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-primary">Submit Review</button>
    </form>
</div>
{% endblock %}
